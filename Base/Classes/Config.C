/***************************************************************************
 *
 *   Copyright (C) 2006 by Willem van Straten
 *   Licensed under the Academic Free License version 2.1
 *
 ***************************************************************************/

// #define _DEBUG 1

#include "Pulsar/Config.h"

// This file is generated by configure
#include "Management/psrchive_install.h"

#include <stdlib.h>

using namespace std;

// global configuration
Configuration* Pulsar::Config::config = 0;

void Pulsar::Config::load_config () try {

  config = new Configuration;

#ifdef _DEBUG
  cerr << "Pulsar::Config::load_config runtime=" << get_runtime () << endl;
#endif

  config->load (get_runtime() + "/psrchive.cfg");
  
  const char* home = getenv ("HOME");
  if (home) {
#ifdef _DEBUG
  cerr << "Pulsar::Config::load_config $HOME=" << home << endl;
#endif
    config->load ( string(home) + "/.psrchive.cfg");
  }

}
catch (Error& error) {
  // use of a configuration file is optional
}


string Pulsar::Config::get_runtime ()
{
  return get_home() + "/share";
}

string Pulsar::Config::get_home ()
{
  char* psrchive = getenv ("PSRCHIVE");
  if (psrchive)
    return psrchive;

  return PSRCHIVE_INSTALL;
}

